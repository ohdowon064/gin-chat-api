<!--index.html-->
<!DOCTYPE html>
<html>
<head>
    <title>Chat</title>
</head>
<body>
<div id="messages"></div>
<form>
    <h1>Chat Room List</h1>
    <ol id="roomList"></ol>
    <input type="text" id="message" />
    <button type="submit">Send</button>
</form>
<script>
    let rooms = []
    fetch("/rooms")
        .then(response => response.json())
        .then(data => {
            const roomList = document.querySelector("#roomList")
            data.forEach(room => {
                const roomItem = document.createElement("li");
                roomItem.textContent = room.name;
                roomList.appendChild(roomItem);
                rooms.push(room)
            })
        })
    var messages = document.getElementById("messages");
    var messageInput = document.getElementById("message");
    var socket = new WebSocket("ws://" + location.host + "/ws");

    socket.onmessage = function(event) {
        var message = event.data;
        var messageNode = document.createElement("div");
        messageNode.innerText = message;
        messages.appendChild(messageNode);
    };

    document.querySelector("form").addEventListener("submit", function(event) {
        event.preventDefault();
        var message = messageInput.value;
        socket.send(message);
        messageInput.value = "";
    });
</script>
</body>
</html>
